<!doctype html>
<html>
<head>
<script src="../../build/out.js"></script>
<script>
var stm, ws = new WebSocket('ws://localhost:9999');
ws.addEventListener('open', function() {
  stm = new checkerboard.STM(ws);
   
  stm.action('create-array')
    .onReceive(function() {
      if (typeof this.a === 'undefined')
        this.a = [];
    });
    
  stm.action('push-to-array')
    .onReceive(function(num) {
      this.a.push(num);
    });
      
  stm.store.sendAction('create-array');
  stm.store.a.addObserver(function(comparand, origin){
    if (comparand.length - origin.length > 0)
      console.log("Added " + (comparand.length - origin.length) + " elements: [" + comparand.slice(origin.length, comparand.length + "]"));
  });
  window.store = stm.store;
  stm.store.sendAction('push-to-array', 0);

});


</script>